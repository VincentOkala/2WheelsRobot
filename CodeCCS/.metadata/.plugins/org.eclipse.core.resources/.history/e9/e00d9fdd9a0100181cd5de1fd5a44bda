#include <stdint.h>
#include <stdbool.h>

#include <stdint.h>
#include <stdbool.h>
#include <inc/hw_gpio.h>
#include "inc/hw_types.h"
#include "inc/hw_memmap.h"
#include "driverlib/sysctl.h"
#include "driverlib/pin_map.h"
#include "driverlib/gpio.h"
#include "driverlib/pwm.h"
#include "driverlib/adc.h"
#include "driverlib/sysctl.h"

#include "driverlib/sysctl.h"

#include "MPU6050/MPU6050.h"
#include "UART0/UART.h"
#include "Engine/Engine.h"

double cr_pitch;
double cr_pitch_raw;
int main(void)
{
    SysCtlClockSet(SYSCTL_SYSDIV_2_5 | SYSCTL_USE_PLL | SYSCTL_OSC_MAIN | SYSCTL_XTAL_16MHZ);
    MPU6050_Start();
    UART_Start(115200);
    ENGINE_Start();

    //    SysCtlPeripheralEnable(SYSCTL_PERIPH_GPIOF);
    //    while(!SysCtlPeripheralReady(SYSCTL_PERIPH_GPIOF));
    //
    //    HWREG(GPIO_PORTF_BASE + GPIO_O_LOCK) = GPIO_LOCK_KEY;
    //    HWREG(GPIO_PORTF_BASE + GPIO_O_CR) |= 0x01;
    //    HWREG(GPIO_PORTF_BASE + GPIO_O_LOCK) = 0;
    //    GPIODirModeSet(GPIO_PORTF_BASE, GPIO_PIN_4|GPIO_PIN_0, GPIO_DIR_MODE_IN);
    //    GPIOPadConfigSet(GPIO_PORTF_BASE, GPIO_PIN_4|GPIO_PIN_0, GPIO_STRENGTH_2MA, GPIO_PIN_TYPE_STD_WPU);

    while(1){
        cr_pitch = MPU6050_Get_Pitch();
        cr_pitch_raw = MPU6050_Get_Pitch_Raw();
        UARTprintf("-900 %d %d 900\n",(int)(cr_pitch*1000),(int)(cr_pitch_raw*1000));
        SysCtlDelay(10000);
    }
}
